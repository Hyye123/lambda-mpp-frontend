# Гайд для разработчиков ботов и программистов в Lambda MPP

Этот гайд содержит основную информацию о том, что можно делать с ботами, что нельзя, а также некоторые инструменты, чтобы помочь вам начать.

[Оригинальный Гайд для разработчиков ботов и программистов в MPP](https://docs.google.com/document/d/1OrxwdLD1l1TE8iau6ToETVmnLuLXyGBhA0VfAY1Lf14/edit?usp=sharing) был использован за основу.

# **Хорошие виды использования ботов**

* Система фейковой валюты с мини-играми для пользователей  
* Отслеживание истории имён  
* Соединение чата в некоторых каналах с другими местами (например, Discord)  
* Управление комнатой или хранение короны в ней, пока владелец не в игре или AFK  
* Поиск пользователей на сайте  
* MIDI-плееры  
  * Старайтесь не использовать MIDI-плееры в комнатах, владелец которых не разрешает использование MIDI  
* Перевод текста  
* Чат с искусственным интеллектом  
* Обучение программированию
* Боты, которые вместе играют на пианино или вместе создают анимацию.

# **Что не разрешено**

Бот и его владелец могут быть забанены за следующее:

* Если ваш бот проходит по всем каналам (например, чтобы отслеживать историю имён или для поиска пользователей), вы должны пропускать комнаты с параметром "noindex": true в настройках канала. Эта настройка предназначена для того, чтобы пользователи могли отказаться от ботов по соображениям конфиденциальности. Вы можете учитывать комнаты с noindex в глобальном подсчёте игроков, однако, любой бот, автоматически заходящий в такие комнаты, может быть забанен.  
* Злоупотребление кодом или эксплойтами, чтобы пролагивать сервер или как-либо ломать его (сообщайте администраторам о багах, если их находите\!)  
* Использование ботов, чтобы нарушать [правила сайта](https://github.com/Hyye123/lambda-mpp-frontend/blob/main/ru-rules.md)  
* Использование ботов с намерением сделать сайт хуже для других людей  
  * Например: Бот, который автоматически ходит по комнатам и оскорбляет пользователей  
  * Например: Бот, который автоматически обходит комнаты и спамит пианино, пока его не забанят.  
* Использование сайта в обычном режиме через пользователя, имеющего тег BOT  
  * Этот тег предназначен для обозначения того, что пользователь не является настоящим человеком. По этой причине тег BOT не будет выдаваться ботам, работающим в браузере.  
* Спам сообщениями, которые ничего не делают  
  * Например: Пытаться установить имя бота каждую секунду, когда его имя уже является желаемым именем  
  * Например: Отправлять ch для присоединения к каналу в интервале, когда бот уже находится в этом канале  
  * Например: Отправлять сотни движений курсора в секунду (сервер ограничивает количество движений курсора до 20 в секунду)

## Серая зона:

Есть некоторые вещи, которые бот может делать, которые явно не разрешены или запрещены и будут рассматриваться в каждом конкретном случае.

* Использование ботов для захвата короны в комнате  
  * Если владелец комнаты ушёл, использование скрипта, который автоматически забирает корону, разрешено при условии, что вы вернете ее владельцу, если он снова присоединится.  
  * Использование бота, чтобы ждать, пока чужая комната не будет покинута, а затем вечно держать там корону, не разрешено.  
* Попытки обойти систему защиты от ботов  
  * Анализ и попытки реверс-инжиниринга кода разрешены  
  * Если вы тестируете обход и получите автоматический бан, вы не будете разбанены.

# **Важное замечание о безопасности**

Не доверяйте серверу при разработке ботов. Сервер может отправить вашему боту вредоносные/поддельные сообщения через эксплойт или взлом с нашей стороны. Если вы решили реализовать команду eval или что-то подобное, держите ее в песочнице, иначе ответственность будет лежать на вас.

# **Система защиты от ботов**

Боты в MPP исторически использовались для выведения сайта из строя, засорения чата, пролагивания игроков за счёт спама на пианино и злоупотребления багами. В результате, была внедрена система защиты от ботов, и теперь боты гораздо более ограничены. Обнаружение анти-ботом приведет к бану на 24 часа. Этот бан не столько наказание, сколько способ усложнить процесс реверс-инжиниринга. Если вы случайно получили бан, напишите мне в Discord (hyye.xyz), и есть большая вероятность, что я сниму его. Обход автобана не допускается, если вы намеренно пытались обойти систему.

# **Боты в браузере**

Если вы хотите создать бота в браузере, есть несколько руководств для [начинающих](https://gist.github.com/Hri7566/34565985e54632f815f15323704a0919) и [средних](https://gist.github.com/Hri7566/117511ec6888db2cf4c1debde1d1a9b6) программистов JavaScript (на английском языке). Один из распространенных способов их использования — [Tampermonkey](https://www.tampermonkey.net/).

Боты в браузере не требуют одобрения. Из-за природы системы защиты от ботов существуют ограничения на то, что вы можете делать с ними.   
В целом, добавление функционала на сайт должно быть безопасным, например, добавление слушателей событий в MPP.client и вызов функций в глобальном объекте MPP разрешены и в основном безопасны. Изменение темы сайта (CSS и HTML) обычно также не представляет опасности. Изменение существующих свойств или функций может привести к бану, особенно в Client.js.

# **Боты вне браузера**

Все боты, которые не запускаются в браузере, требуют одобрения. Это связано с тем, что ими гораздо легче злоупотреблять. Ваш клиент должен будет отправлять токен бота при каждом подключении, чтобы авторизоваться. См. [документацию по протоколу](https://github.com/mppnet/frontend/blob/main/docs/protocol.md). Чтобы получить токен, напишите мне в Discord (hyye.xyz).

Боты, работающие вне браузера и использующие токен, получают тег BOT. Этот тег означает, что пользователь не будет исследовать комнаты, общаться и играть на пианино как человек, и что он всего лишь бот.

## **Node.js**

Если ваш бот работает на Node.js, лучшим выбором будет [mpp-client-net](https://www.npmjs.com/package/mpp-client-net). Этот модуль поддерживает токены по умолчанию и предназначен для использования с MPPNet (совместим с Lambda MPP).

Если вы немного более опытны, рекомендуется использовать модуль [dotenv](https://www.npmjs.com/package/dotenv) для сохранения секретности вашего токена, но мы не можем предоставить точных инструкций для любого конкретного сценария.

## **Deno**

Если ваш бот работает на Deno, лучшим выбором будет [mppclient@v1.0.0](https://deno.land/x/mppclient@v1.0.0) (также известный как mpp-client-deno). Этот модуль функционально идентичен [mpp-client-net](https://www.npmjs.com/package/mpp-client-net) и поддерживает аутентификацию на основе токенов из коробки.

## **Прочие языки**

Если вы знаете клиентскую библиотеку для другого языка или пишете её, свяжитесь с hyye.xyz в Discord, и она может быть добавлена в этот документ.

# Исходный код и документация по протоколу

Исходный код сервера является закрытым. Исходный код клиента является публичным и может быть найден [здесь](https://github.com/Hyye123/lambda-mpp-frontend). Не стесняйтесь открывать проблемы или делать запросы на исправление новых возможностей или ошибок. Информацию о протоколе, который использует lmpp.hyye.xyz, можно найти на [вики-странице протокола](https://github.com/Hyye123/lambda-mpp-frontend/blob/main/docs/protocol.md).